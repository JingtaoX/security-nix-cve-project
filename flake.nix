{
  inputs = {
    nixpkgs.url = "nixpkgs/nixos-unstable";

    # TODO make this into it's own file to make this cleaner

    tree-grepper.url = "github:BrianHicks/tree-grepper";
    tree-grepper.inputs.nixpkgs.follows = "nixpkgs";
  };

  description = "Some flake";
  outputs = { self, nixpkgs, tree-grepper, ... }:
    let
      system = "x86_64-linux";
      pkgs = import nixpkgs { inherit system; };
      jsonformer =
        pkgs.python3Packages.callPackage ./nix/packages/jsonformer-init.nix { };
      go-cve-dictionary =
        pkgs.callPackage ./nix/packages/go-cve-dictionary.nix { };

    in {
      pkgs = pkgs;

      lib = let
        writeNuShell = import ./nix/lib/writeNuShellBin {
          nushell = pkgs.nu;
          writeTextFile = pkgs.writeTextFile;
        };
      in { inherit writeNuShell; };
      # jsonformer = jsonformer1;
      devShells."${system}".default = pkgs.mkShell {
        buildInputs = with pkgs; [
          (python3.withPackages
            (p: with p; [ transformers pytorch beautifulsoup4 jsonformer ]))
          # lsp server for python
          nodePackages.pyright
          fd
          ripgrep
          exploitdb
          go-exploitdb
          (tree-grepper.defaultPackage."${system}")
          go-cve-dictionary

        ];
      };
    };
}

