{
  inputs = {
    nixpkgs.url = "nixpkgs/nixos-unstable";

    # TODO make this into it's own file to make this cleaner
    jsonformer = {
      type = "github";
      owner = "1rgs";
      repo = "jsonformer";
      flake = false;
    };
  };

  description = "Some flake";
  outputs = { self, nixpkgs, ... }:
    let
      system = "x86_64-linux";
      pkgs = import nixpkgs { inherit system; };
      jsonformer = pkgs.python3Packages.buildPythonPackage rec {
        pname = "jsonformer";
        src = self.inputs.jsonformer;
        version = "0.12.0";
        format = "pyproject";
        # buildInputs = [ pkgs.poetry ];

        nativeBuildInputs = [ pkgs.python3.pkgs.poetry-core ];
      };
      hyperqueue = pkgs.callPackage ./nix/hyperqueue.nix { };
    in {
      devShells."${system}".default = pkgs.mkShell {
        buildInputs = with pkgs; [
          (python3.withPackages
            (p: with p; [ transformers pytorch termcolor beautifulsoup4 ]))
          # lsp server for python
          nodePackages.pyright
          jsonformer
          hyperqueue

        ];
      };
    };
}

